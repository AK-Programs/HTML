<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computer Quiz - 7</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="/Images/AK-Programs-Logo.png"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">

    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .quiz-container {
            width: 90%;
            max-width: 600px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .question {
            margin-bottom: 10px;
            text-align: left;
        }
        .options label {
            display: block;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #ddd;
        }
        .options input[type="radio"] {
            display: none;
        }
        .options input[type="radio"]:checked + label {
            background-color: #007bff;
            color: white;
        }
        .correct-answer {
            background-color: #c8e6c9 !important;
            border-color: green !important;
        }
        .wrong-answer {
            background-color: #ffcccb !important;
            border-color: red !important;
        }
        #result {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 10px;
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }
        #submit {
            background-color: #28a745;
            color: white;
        }
        #submit:hover {
            box-shadow: 0 0 15px rgba(40, 167, 69, 0.7);
        }
        #reset {
            background-color: #dc3545;
            color: white;
            display: none;
        }
        #reset:hover {
            box-shadow: 0 0 15px rgba(220, 53, 69, 0.7);
        }
        @media (max-width: 768px) {
            .quiz-container {
                width: 95%;
            }
        }

        .madeBy
        {
            font-size: 15px;
            color: #000000;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        h1
        {
            background-color: blue;
            box-shadow: 0 0 10px darkblue;
            border-radius: 8px;
        }
        
    </style>
</head>
<body>
    <div class="quiz-container">
        <h1>Computer Quiz - 7th Std</h1>
        <div id="quiz"></div>
        <button id="submit" class="btn">Submit Quiz</button>
        <!-- <button id="reset" class="btn">Reset Quiz</button> -->
        <div id="result"></div>
        <p class="madeBy"> <i class="fa-solid fa-user"></i> Made by Naitik Kashyap</p>
    </div>
    <script>  
        const allQuestions = [  
        { question: "______ identifies the data fill pattern and then fills the remaining series, accordingly.", options: ["Auto Fill", "Smart Fill", "Flash Fill", "Data Fill"], answer: "Flash Fill" },  
            { question: "Press _____ to apply an outline border around the selected cell or a range of cells.", options: ["Ctrl + Shift + 8", "F2", "Ctrl + Shift + 7", "Alt + 7"], answer: "Ctrl + Shift + 7" },  
            { question: "The _____ error occurs if the numbers is divided by zero.", options: ["#DIV/0", "###", "#value!", "#NUM/0"], answer: "#DIV/0" },  
            { question: "The ____ function is used to display the current data.", options: ["=now()", "=Today()", "=Date()", "=currentDate()"], answer: "=Today()" },  
            { question: "_____ are horizontal or verticle lines depending on the selected chart type.", options: ["Chart Lines", "Grindlines", "Bar Lines", "Legend"], answer: "Grindlines" },  
            { question: "_____ data means combining the data of multiple worksheets into a single worksheet.", options: ["Grouping", "Consolidating", "Reapply", "Filter"], answer: "Consolidating" },  
            { question: "It is mandatory in Python to _____ the statement in the condition body, otherwise it will display an error.", options: ["Precedence", "Interactive", "else", "Indent"], answer: "Indent" },  
            { question: "____ and Flowchart help you to solve complex problems in steps.", options: ["Algorithm", "Operators", "Variable", "Operands"], answer: "Algorithm" },  
            { question: "Binary operators operate on _____ operands.", options: ["Five", "Four", "Two", "Three"], answer: "Two" },  
            { question: "A _____ is a text message given to a web browser by a web server.", options: ["Firewall", "Cookie", "Biometrics", "Antivirus"], answer: "Cookie" },  
            { question: "_____ is a crime in which the victim is attacked first and then forced to pay money to stop further attacks.", options: ["Hacking", "Phising", "Cyber Extortion", "Forgery"], answer: "Cyber Extortion" },  
            { question: "What do you call the process that converts the electronic data into a form that cannot be understood by anyone?", options: ["Cyber bullying", "Encryption", "Custom scan", "Antivirus"], answer: "Encryption" },  
            { question: "____ is the easiest method to fill the consecutive data items automatically in worksheet cell.", options: ["Flash Fill", "Filler", "Auto Fill", "Smart Fill"], answer: "Auto Fill" },  
            { question: "____ are input to functions which accept values as numbers or text.", options: ["Formula", "Arguments", "Function", "Parameters"], answer: "Arguments" },  
            { question: "A ____ is a related set of data values.", options: ["Data Series", "Data Object", "Columns", "Plot"], answer: "Data Series" },  
            { question: "What is the full form of IC?", options: ["Information Client", "Integrated Circuit", "Internet Control", "Instant Control"], answer: "Integrated Circuit" },  
            { question: "What is the full form of GUI?", options: ["Graphical User Interface", "Graphics User Information", "Generic User Interaction", "Guided User Instruction"], answer: "Graphical User Interface" },  
            { question: "What is the full form of UPS?", options: ["Universal Power System", "United Power Storage", "Unit Power System", "Uninterrupted Power Supply"], answer: "Uninterrupted Power Supply" },  
            { question: "What is the full form of DVD?", options: ["Digital Video Disc", "Digital Versatile Disc", "Data Versatile Drive", "Digital Visual Display"], answer: "Digital Versatile Disc" },  
            { question: "What is the full form FTP?", options: ["Fast Transfer Protocol", "File Transmission Program", "File Transfer Protocol", "Fast Transmission Program"], answer: "File Transfer Protocol" }  
            ];  
            
            function loadQuiz() {  
                document.getElementById("quiz").innerHTML = "";  
                let quizData = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 20);  
                
                quizData.forEach((q, index) => {  
                    let options = q.options.sort(() => 0.5 - Math.random());  
                    const questionElement = document.createElement("div");  
                    questionElement.classList.add("question");  
                    questionElement.innerHTML = `<p>${index + 1}. ${q.question}</p>`;  
                    const optionsContainer = document.createElement("div");  
                    optionsContainer.classList.add("options");  
                    
                    options.forEach(option => {  
                        optionsContainer.innerHTML += `<input type="radio" name="q${index}" value="${option}" id="q${index}-${option}">   
                        <label for="q${index}-${option}">${option}</label>`;  
                    });  
                    
                    questionElement.appendChild(optionsContainer);  
                    document.getElementById("quiz").appendChild(questionElement);  
                    
                });  
                
                // Hide submit button initially  
                document.getElementById("submit").style.display = "none";  
                
                // Add event listener to enable submit button when all are answered  
                document.querySelectorAll('input[type="radio"]').forEach(radio => {  
                    radio.addEventListener("change", checkIfAllAnswered);  
                });  
            }  
            
            function checkIfAllAnswered() {  
                let allAnswered = true;  
                document.querySelectorAll(".question").forEach((question, index) => {  
                    if (!document.querySelector(`input[name="q${index}"]:checked`)) {  
                        allAnswered = false;  
                }  
            });  
            
            if (allAnswered) {  
                document.getElementById("submit").style.display = "block";  
            } else {  
                document.getElementById("submit").style.display = "none";  
            }  
        }  
        
        function getURLParams() {  
            const urlParams = new URLSearchParams(window.location.search);  
            return {  
                firstName: urlParams.get('firstName'),  
                lastName: urlParams.get('lastName'),  
                rollNo: urlParams.get('rollNo'), // Get roll number  
                std: urlParams.get('std'),  
                section: urlParams.get('section')  
            };  
        }  


        document.getElementById("submit").addEventListener("click", () => { 
            const conformation = confirm("Make sure to check all answers before submitting. Once you submit you will get your score as per your answer.\nIf Everything is checked, click OK \nIf you want to check, click Cancel");
            if (conformation) {
                
                let score = 0; // Initialize score counter  
                let totalQuestions = 20; // Total number of questions  

                document.querySelectorAll(".question").forEach((question, index) => {  
                    let selected = document.querySelector(`input[name="q${index}"]:checked`);  
                    let correctAnswer = allQuestions[index].answer;  
                    let labels = question.querySelectorAll("label");  

                    labels.forEach(label => {  
                        if (label.innerText === correctAnswer) {  
                            label.classList.add("correct-answer");  
                        } else if (label.previousElementSibling.checked) {  
                            label.classList.add("wrong-answer");  
                        }  
                    });  
                    
                    // Increase score if the selected answer is correct  
                    if (selected && selected.value === correctAnswer) {  
                        score++;  
                    }  
                });  

                // Disable all radio buttons to prevent changes after submission  
                document.querySelectorAll('input[type="radio"]').forEach(radio => {  
                    radio.disabled = true;  
                });  

                // Display score and make it visible  
                document.getElementById("result").innerText = `Your Score: ${score}/${totalQuestions}`;  
                document.getElementById("result").style.display = "block"; // Show score  
                document.getElementById("submit").style.display = "none";  
                // document.getElementById("reset").style.display = "block";  

                // === Send score to Google Sheet ===  
                const scriptURL = 'https://script.google.com/macros/...';  // Add your macros script from google sheets
                const formData = new FormData();  
                const userInfo = getURLParams(); // Get user info  

                formData.append("firstName", userInfo.firstName);  // Add first name  
                formData.append("lastName", userInfo.lastName);    // Add last name  
                formData.append("rollNo", userInfo.rollNo);      // Add roll number  
                formData.append("std", userInfo.std);    // Add class  
                formData.append("section", userInfo.section); // Add section  
                formData.append("Score", score);          // Add score  
                formData.append("total", totalQuestions); // Total possible score  
                formData.append("timestamp", new Date().toLocaleString()); // Send the timestamp  

                fetch(scriptURL, { method: 'POST', body: formData })  
                    .then(response => console.log("Score Sent Successfully"))  
                    .catch(error => console.error("Error sending score")) 
            } else {
                return;
            }
        });    

        // Reset Quiz  
        //document.getElementById("reset").addEventListener("click", () => {  
          //  loadQuiz();  
            //document.getElementById("reset").style.display = "none";  
          //  document.getElementById("result").innerText = ""; // Reset score text  
          //  document.getElementById("result").style.display = "none"; // Hide score  
          // });  
          
          loadQuiz();  
          
    </script>  
    
</body>

</html>
